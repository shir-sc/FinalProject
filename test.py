import numpy as np
import tile_coding
import scipy
from scipy import stats
import matplotlib.pyplot as plt
from scipy.stats import geom



# state_size= (4,2)
# print(state_size+(len([1,2,3,4,5,6]),))
# print('Q_table')
# Q_table= np.zeros(shape=(state_size+(len([1,2,3,4,5,6]),)))
# print(Q_table)

# feature_ranges = [[0, 180], [0, 90]]  # 2 features
# number_tilings = 3
# bins = [[4, 2], [4, 2], [4, 2]]  # each tiling has a 4*2 grid
# offsets = [[0, 0], [15, 15], [30, 30]]  # each tiling has different offset from the 0,0
# tilings = tile_coding.create_tilings(feature_ranges, number_tilings, bins, offsets)
#
#
# state_sizes = [tuple(len(splits)+1 for splits in tiling) for tiling in tilings]
# print (state_sizes)
# print('Q_tables')
# Q_tables= [np.zeros(shape=(state_size+(len([1,2,3,4,5,6]),)))for state_size in state_sizes]
# print (Q_tables)


# actions=range(6)
# print(actions)
# state = [(7,8),1,1,1]
# print ((state[0])[1])

#
# # np.expand.grid(0:5,0:8,0:3,0:7,0:2)
# Rono = np.array(np.meshgrid([1, 2, 3, 4, 5,6], [1,2,3,4,5,6,7,8,9], [0,1,2,3],[0,1,2,3,4,5,6,7],[0,1,2])).T.reshape(-1,5)
# print(len(Rono))
# print (Rono)

# Rono = np.array(np.meshgrid((np.array(np.meshgrid([0, 1, 2, 3, 4, 5], [0, 1, 2, 3, 4, 5, 6,7,8])).T.reshape(-1,2)), [0,1,2,3],[0,1,2,3,4,5,6,7],[0,1,2])).T.reshape(-1,4)
# print(len(Rono))
# print (Rono)

# print (len(np.array(np.meshgrid([0, 1, 2, 3], [0, 1],[0, 1, 2, 3], [0, 1],[0, 1, 2, 3], [0, 1], [0, 1, 2, 3], [0, 1, 2, 3, 4, 5, 6, 7],
#                                   [0, 1, 2])).T.reshape(-1, 9)))

#
# state = [(0,1),2,3,4]
# NewState = ((state[0])[0],(state[0])[1],state[1],state[2],state[3])
# print(NewState)
# smart = [(item for t in state[0] for item in t],state[1],state[2],state[3])

# # Python code to convert list of tuples into list
#
# # List of tuple initialization
# lt = [('Geeks', 2), ('For', 4), ('geek', '6')]
#
# # using list comprehension
# out = [item for t in lt for item in t]
#
# # printing output
# print(out)

# offsets = [[i, j] for i, j in zip(np.linspace(0, 180, 3), np.linspace(0, 90, 3))]
# print (offsets)
#
# bins = [[16, 16] for _ in range(3)]
# print(bins)

# print((-5)%0)
data={}
data={'two steps x1': [100, 0, 18, 0, 0, 0, 24, 0, 100, 3, 0, 100, 1, 1, 100, 0, 49, 1, 0, 0, 1, 100, 0, 0, 0, 100, 0, 0, 0, 100, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 7, 0, 1, 0, 1, 0, 2, 1, 5, 0, 0, 0, 0, 8, 1, 1, 0, 12, 0, 0, 1, 0, 0, 2, 1, 0, 0, 100, 0, 0, 0, 3, 5, 3, 0, 1, 0, 22, 7, 0, 1, 1, 0, 0, 17, 0, 0, 0, 0, 0, 0, 0, 21, 0, 0, 0, 0, 0, 0, 0, 0, 1, 100, 0, 0, 0, 0, 4, 0, 19, 10, 1, 0, 1, 0, 3, 100, 1, 29, 0, 100, 0, 100, 100, 0, 1, 1, 1, 0, 0, 9, 1, 11, 0, 2, 0, 0, 3, 19, 0, 3, 100, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 100, 20, 0, 100, 0, 0, 100, 0, 0, 1, 35, 0, 5, 2, 2, 0, 1, 0, 7, 0, 0, 0, 10, 0, 9, 9, 100, 1, 1, 0, 0, 0, 0, 100, 100, 0, 100, 0, 0, 1, 0, 0, 0, 45, 0, 13, 0, 0, 1, 0, 0, 25, 0, 1, 0, 0, 100, 100, 0, 2, 3, 0, 0, 100, 7, 0, 0, 0, 1, 0, 0, 0, 1, 3, 100, 100, 3, 1, 25, 0, 7, 100, 100, 7, 0, 0, 4, 1, 1, 0, 0, 21, 39, 79, 0, 1, 0, 2, 0, 0, 1, 2, 5, 0, 12, 5, 0, 0, 0, 0, 3, 0, 0, 0, 0, 2, 100, 2, 0, 0, 1, 0, 0, 1, 0, 0, 0, 100, 9, 0, 0, 0, 100, 3, 100, 0, 1, 61, 0, 0, 2, 0, 0, 0, 0, 0, 100, 1, 0, 0, 1, 1, 0, 53, 27, 11, 100, 0, 0, 0, 0, 100, 0, 0, 0, 0, 33, 1, 0, 100, 0, 9, 15, 3, 2, 0, 0, 0, 100, 100, 1, 0, 100, 100, 0, 0, 100, 0, 3, 33, 0, 1, 0, 3, 5, 7, 0, 1, 100, 0, 0, 1, 0, 100, 0, 0, 0, 27, 0, 0, 0, 3, 2, 0, 0, 9, 1, 0, 0, 0, 31, 0, 0, 0, 0, 100, 5, 1, 2, 0, 0, 0, 0, 13, 67, 1, 1, 1, 21, 5, 0, 17, 13, 0, 2, 0, 0, 1, 0, 2, 0, 0, 1, 100, 0, 0, 100, 12, 65, 0, 0, 100, 24, 0, 1, 0, 3, 7, 0, 1, 0, 3, 0, 0, 7, 3, 0, 2, 31, 0, 5, 0, 0, 33, 1, 0, 0, 6, 7, 0, 100, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 100, 0, 0, 0, 4, 0, 0, 100, 0, 2, 9, 15, 0, 14, 11, 0, 100, 0, 0, 2, 7, 0, 0, 6, 15, 1, 0, 1, 0, 0, 0, 1, 0, 0, 4, 100, 0, 0, 100, 0, 0, 30, 5, 0, 0, 1, 0, 11, 38, 0, 0, 1, 1, 3, 1, 6, 0, 100],
      'two steps x2': [100, 1, 2, 0, 0, 0, 2, 1, 1, 1, 0, 0, 0, 0, 0, 0, 100, 100, 0, 0, 1, 0, 1, 1, 3, 1, 1, 100, 0, 0, 0, 21, 0, 11, 2, 100, 100, 0, 0, 3, 59, 1, 0, 0, 100, 0, 0, 0, 0, 0, 0, 3, 100, 65, 1, 0, 63, 5, 0, 0, 0, 0, 0, 0, 0, 100, 13, 0, 0, 1, 11, 0, 0, 3, 0, 0, 0, 1, 1, 11, 0, 1, 0, 1, 7, 0, 1, 100, 0, 5, 0, 1, 18, 0, 0, 0, 51, 0, 0, 13],
'one step x1': [2, 16, 5, 4, 4, 0, 29, 0, 1, 1, 0, 59, 21, 100, 1, 0, 1, 0, 1, 100, 0, 0, 0, 1, 3, 100, 0, 7, 0, 0, 6, 0, 0, 10, 0, 0, 0, 0, 1, 0, 0, 100, 4, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 100, 0, 10, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 6, 0, 0, 0, 1, 1, 1, 1, 5, 0, 1, 0, 0, 0, 0, 100, 2, 11, 0, 35, 31, 2, 35, 7, 48, 0, 0, 3, 0, 0, 0, 0, 0, 1, 3, 0, 100, 1, 100, 4, 8, 9, 0, 2, 0, 0, 0, 0, 13, 2, 100, 0, 7, 0, 0, 0, 10, 1, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 9, 45, 0, 1, 0, 1, 100, 19, 7, 11, 0, 0, 0, 1, 1, 1, 100, 0, 1, 11, 100, 0, 100, 0, 0, 0, 1, 100, 0, 43, 0, 11, 15, 0, 1, 0, 1, 0, 5, 0, 1, 0, 0, 0, 0, 0, 0, 0, 49, 100, 100, 3, 1, 0, 0, 0, 100, 0, 100, 100, 2, 1, 1, 0, 0, 0, 2, 9, 100, 0, 0, 0, 0, 0, 3, 1, 0, 0, 0, 1, 0, 100, 1, 0, 0, 0, 0, 0, 0, 0, 0, 11, 0, 0, 1, 31, 100, 0, 0, 19, 100, 1, 0, 0, 0, 0, 100, 9, 3, 0, 0, 0, 1, 0, 100, 6, 2, 0, 0, 100, 0, 1, 100, 0, 0, 1, 0, 1, 1, 0, 1, 0, 4, 0, 1, 100, 0, 100, 0, 3, 0, 5, 0, 0, 0, 55, 100, 13, 100, 19, 7, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 5, 0, 4, 100, 100, 0, 0, 100, 0, 0, 0, 9, 0, 0, 0, 0, 1, 0, 0, 0, 0, 100, 10, 1, 0, 7, 0, 100, 0, 100, 7, 0, 1, 20, 100, 0, 0, 0, 0, 0, 6, 0, 0, 100, 2, 1, 100, 0, 1, 0, 0, 15, 0, 0, 100, 0, 0, 0, 0, 100, 10, 0, 1, 5, 8, 0, 0, 1, 0, 0, 1, 0, 1, 2, 1, 3, 0, 2, 0, 2, 1, 31, 0, 0, 1, 1, 0, 0, 1, 0, 9, 0, 0, 1, 0, 0, 0, 1, 5, 0, 100, 0, 100, 0, 0, 0, 0, 0, 0, 0, 9, 13, 0, 0, 5, 0, 0, 0, 3, 100, 100, 0, 0, 0, 0, 1, 7, 100, 100, 7, 0, 100, 1, 0, 0, 0, 0, 1, 0, 100, 0, 27, 0, 1, 5, 41, 7, 5, 0, 7, 6, 0, 0, 0, 0, 0, 0, 0, 15, 7, 0, 100, 0, 0, 0, 0, 0, 100, 2, 0, 100, 100, 0, 0, 9, 1, 1, 1, 1, 1, 1, 0, 8, 0, 97, 0, 3, 3, 100, 2, 0, 0, 17, 0, 11, 1, 0, 1, 0, 0, 7, 0, 100, 0, 0, 100, 69, 0, 0, 0, 0, 0, 100, 0, 100, 3, 0, 4, 30, 3, 0, 0, 1, 1],
'one step x2': [100, 3, 0, 0, 1, 15, 1, 2, 100, 0, 2, 9, 0, 0, 0, 100, 1, 0, 1, 1, 3, 0, 0, 0, 0, 0, 100, 2, 100, 3, 0, 0, 0, 0, 0, 0, 5, 100, 0, 0, 0, 1, 16, 1, 0, 0, 19, 5, 0, 0, 2, 3, 44, 100, 1, 100, 0, 0, 2, 0, 0, 0, 5, 3, 100, 100, 0, 2, 0, 0, 0, 0, 0, 1, 0, 3, 100, 0, 0, 19, 2, 1, 0, 3, 4, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 3, 0, 1]}

print (data['two steps x1'])
print (len(data['two steps x1']))
pX2oneStep = 1/np.mean(data['one step x2'])
print ('pX2oneStep', pX2oneStep)
pX2twoSteps = 1/np.mean(data['two steps x2'])
print ('pX2twoSteps', pX2twoSteps)

bins = np.linspace(0, 100,100)
# fitted_data = scipy.stats.distributions.chi2.pdf(bins, p)
plt.hist(data['two steps x1'], density=False, bins=bins)
# # plt.plot(bins, fitted_data, 'r-')
plt.show()



# Theoretical distrebution
fig, ax = plt.subplots(1, 1)

mean, var, skew, kurt = geom.stats(p, moments='mvsk')
print (mean)
print (var)
print (skew)
print (kurt)

x = np.arange(geom.ppf(0.00001, p),geom.ppf(0.99999, p))
print x
ax.plot(x, geom.pmf(x, p), 'bo', ms=8, label='geom pmf')
ax.vlines(x, 0, geom.pmf(x, p), colors='b', lw=5, alpha=0.5)
plt.show()